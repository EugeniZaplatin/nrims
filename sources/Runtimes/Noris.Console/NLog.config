<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <!-- 
  See https://github.com/nlog/nlog/wiki/Configuration-file 
  for information on customizing logging rules and outputs.
   -->

  <extensions>
    <add assembly="Gelf4NLog.Target"/>
  </extensions>


  <targets>
    <target xsi:type="ColoredConsole"
            name="console"
            layout="${message}"
            useDefaultRowHighlightingRules="false">
      <highlight-word text="Обновляются" foregroundColor="Yellow" />
      <highlight-word text="Игнорировано обновление сущности" foregroundColor="DarkMagenta" />
      <highlight-word text="Добавлена связь" foregroundColor="Green" />
      <highlight-word text="Не найдена связанная запись" foregroundColor="Red" />
    </target>
      
    
    <target  name="file" 
             xsi:type="File" 
             fileName="${basedir}/logs/${shortdate}.log" 
             layout="${longdate} | ${level:uppercase=true:padding=-5:fixedlength=true} | ${logger} - ${message} ${exception:format=tostring}" />
    
    <!--Для сбора статистических данных, котрые потом удобно будет перенести в Excel для анализа-->
    <target  name="fileImportStatistic"
         xsi:type="File"
         fileName="${basedir}/logs/ImportStatistic_${shortdate}.log"
         layout="${longdate} : ${message}" />
     
    <target  name="fileError"
         xsi:type="File"
         fileName="${basedir}/logs/Error_${shortdate}.log"
         layout="${longdate} | 
                 ${level:uppercase=true:padding=-5:fixedlength=true} | 
                 ${logger} - 
                 ${message} ${exception:format=tostring} 
                 ${stacktrace:format=DetailedFlat:topFrames=10}" />

     
    <target  name="fileWarn"
         xsi:type="File"
         fileName="${basedir}/logs/Warn_${shortdate}.log"
         layout="${longdate} | ${level:uppercase=true:padding=-5:fixedlength=true} | ${logger} - ${message} ${exception:format=tostring}" />
    
    <target name="graylog" 
            xsi:type="graylog" 
            hostip="54.87.105.183" 
            
            hostport="12201" 
            facility="test-runtime" />
    <!--
    <target xsi:type="Database"
          name="db"
          dbUserName="Layout"
          dbProvider="String"
          useTransactions="Boolean"
          connectionStringName="DbConnection"
          connectionString="Layout"
          keepConnection="Boolean"
          dbDatabase="Layout"
          dbPassword="Layout"
          dbHost="Layout"
          installConnectionString="Layout"
          commandText="Layout">
      <install-command commandType="Enum" connectionString="Layout" ignoreFailures="Boolean" text="Layout"/>
      <uninstall-command commandType="Enum" connectionString="Layout" ignoreFailures="Boolean" text="Layout"/>
      <parameter layout="Layout" name="String" precision="Byte" scale="Byte" size="Integer"/>
    </target>
    -->
    
  </targets>

  <rules>

    <!-- Intagration module -->
    <logger name="*" level="Info" writeTo="fileImportStatistic" />
    <logger name="*" level="Warn" writeTo="fileWarn" />
    <logger name="*" level="Error" writeTo="fileError" />
    <logger name="*" minlevel="Trace" writeTo="console" />
    <logger name="*" minlevel="Trace" writeTo="file" />
    
    
    <!--
      <logger name="*" minlevel="Info" writeTo="graylog" />
     <logger name="*" level="Trace" writeTo="db" />
     <logger name="*" minlevel="Trace" writeTo="f" />
    -->
  </rules>
</nlog>